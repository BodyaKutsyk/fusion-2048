!function(){function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(t,r){if(t){if("string"==typeof t)return e(t,void 0);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(t,void 0)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var n={GameClass:/*#__PURE__*/function(){var e,n;function o(e){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,o),this.HTML_CELLS=e,this.HTML_MATRIX=[],this.madeMove=!1,this.isGameStarted=!1,this.winStatus=!1,this.score=0}return e=[{key:"randomNumber",value:function(e,t){return Math.floor(Math.random()*(t-e)+e)}},{key:"rotateMatrix",value:function(e){for(var r=e.map(function(e){return t(e)}),n=0;n<e.length;n++)for(var o=0;o<e[n].length;o++)r[n][o]=e[e.length-1-o][n];return r}},{key:"reverseRotate",value:function(e){for(var r=e.map(function(e){return t(e)}),n=0;n<e.length;n++)for(var o=0;o<e[n].length;o++)r[n][o]=e[o][e[n].length-1-n];return r}},{key:"randomCell",value:function(e){for(var t=[],r=0;r<e.length;r++){for(var n=[r],o=0;o<e[r].length;o++)0===e[r][o]&&n.push(o);n.length>1&&t.push(n)}var a=this.randomNumber(0,t.length),i=t[a];if(i){var l=this.randomNumber(1,i.length),c=.9>Math.random()?2:4,s=i[0],f=i[l];return e[s][f]=c,[s,f]}}},{key:"canMoveVerticaly",value:function(e){for(var t=0;t<e.length;t++)for(var r=0;r<e[t].length-1;r++)if(e[t][r]===e[t][r+1])return!0;return!1}},{key:"canMoveHorizontaly",value:function(e){for(var t=0;t<e.length-1;t++)for(var r=0;r<e[t].length;r++)if(e[t][r]===e[t+1][r])return!0;return!1}},{key:"hasEmptySpace",value:function(e){for(var t=0;t<e.length;t++)for(var r=0;r<e[t].length;r++)if(0===e[t][r])return!0;return!1}},{key:"moveLeft",value:function(e,t,r,n){for(var o=function(e){if(0!==i[e])for(var o=e,l=e-1;l>=0;l--)!function(l){if(0===i[l]&&(!n&&(i[l]=i[o],a[t][e]++,i[o]=0,r[e].after||(r[e].after=e,r[e].before=e),r[e].after--,r[e].before=e,o--),n)){var c=!0;if(i[l]=i[o],i[o]=0,r.forEach(function(e){e.after===o&&(a[t][e.before]++,c=!1)}),c)for(var s=e;s<i.length;s++)0===i[s]&&a[t][s]++}}(l)},a=this.moveList,i=e[t],l=0;l<i.length;l++)o(l);return i}},{key:"moveRight",value:function(e,t,r,n){for(var o=function(e){if(0!==i[e])for(var o=e,l=e+1;l<i.length;l++)!function(l){if(0===i[l]&&(!n&&(i[l]=i[o],a[t][e]++,i[o]=0,r[e].after||(r[e].after=e),r[e].after++,r[e].before=e,o++),n)){var c=!0;if(i[l]=i[o],i[o]=0,r.forEach(function(e){e.after===o&&(a[t][e.before]++,c=!1)}),c)for(var s=e;s>=0;s--)0===i[s]&&a[t][s]++}}(l)},a=this.moveList,i=e[t],l=i.length-1;l>=0;l--)o(l);return i}},{key:"mergeLeft",value:function(e,t,r){for(var n=this,o=function(o){if(e[o]===e[o+1]&&0!==e[o]){e[o]+=e[o+1],n.score+=e[o];var i=!0;t.forEach(function(e){e.after===o+1&&(r[e.before]++,i=!1)}),i&&r[o+1]++,e[o+1]=0,o++}a=o},a=0;a<e.length;a++)o(a)}},{key:"mergeRight",value:function(e,t,r){for(var n=this,o=function(o){if(e[o]===e[o-1]&&0!==e[o]){e[o]+=e[o-1],n.score+=e[o];var i=!0;t.forEach(function(e){e.after===o-1&&(r[e.before]++,i=!1)}),i&&r[o-1]++,e[o-1]=0,o--}a=o},a=e.length-1;a>=0;a--)o(a)}},{key:"moveField",value:function(e,t,r){for(var n=this,o=this.rotateMatrix(e),a=0;a<e.length;a++){var i=e[a],l=[{},{},{},{}],c=0;switch(t){case"ArrowLeft":i=this.moveLeft(e,a,l,c),c=1,this.mergeLeft(i,l,r[a]),e[a]=i,e[a]=this.moveLeft(e,a,l,c);break;case"ArrowRight":i=this.moveRight(e,a,l,c),c=1,this.mergeRight(i,l,r[a]),e[a]=i,e[a]=this.moveRight(e,a,l,c);break;case"ArrowUp":i=this.moveRight(o,a,l,c),c=1,this.mergeRight(i,l,r[a]),e[a]=i,e[a]=this.moveRight(o,a,r,l,c);break;case"ArrowDown":i=this.moveLeft(o,a,l,c),c=1,this.mergeLeft(i,l,r[a]),e[a]=i,e[a]=this.moveLeft(o,a,l,c)}}("ArrowUp"===t||"ArrowDown"===t)&&(e.forEach(function(t,r){e[r]=n.reverseRotate(o)[r]}),this.moveList=this.reverseRotate(r))}},{key:"visualize",value:function(e,t){var r=this,n=this.FIELD,o=this.HTML_MATRIX,a=this.moveList,i=t;t||(i=n);for(var l=0,c=!0,s=0;s<i.length;s++)for(var f=0;f<i[s].length;f++)i[s][f]===n[s][f]&&l++;l===n.length*n.length&&(c=!1);for(var u=0;u<i.length;u++)for(var m=0;m<i[u].length;m++){for(;o[u][m].firstChild;)o[u][m].removeChild(o[u][m].lastChild);var h=document.createElement("div");h.innerText="",h.classList="",i[u][m]>0&&(h.style.zIndex="2",h.innerText="".concat(i[u][m]),this.animateMovement(h,e,a[u][m]),h.classList="\n          field-cell\n          field-cell--inner-block\n          field-cell--".concat(i[u][m]),o[u][m].appendChild(h))}setTimeout(function(){for(var e=0;e<n.length;e++)for(var t=0;t<n[e].length;t++){for(var i=o[e][t];i.firstChild;)i.removeChild(i.lastChild);var l=document.createElement("div");l.innerText="",l.classList="",n[e][t]>0&&(l.style.zIndex="2",l.innerText="".concat(n[e][t]),l.classList="\n            field-cell\n            field-cell--inner-block\n            field-cell--".concat(n[e][t]),o[e][t].appendChild(l)),a[e][t]=0}if(r.hasEmptySpace(n)&&c&&r.madeMove){var s=document.createElement("div");setTimeout(function(){var e=r.randomCell(n);s.innerText="".concat(n[e[0]][e[1]]),s.classList="\n          field-cell\n          field-cell--inner-block\n          only-created\n          field-cell--".concat(n[e[0]][e[1]]),o[e[0]][e[1]].appendChild(s)},100)}},50)}},{key:"animateMovement",value:function(e,t,r){var n=85*r,o="",a=0;switch(t){case"ArrowUp":o="top";break;case"ArrowDown":o="bottom";break;case"ArrowLeft":o="left";break;case"ArrowRight":o="right"}e.style[o]="0px",e.style.zIndex="1",setTimeout(function(){(a+=n/r)>=n&&(a=n),e.style[o]=-n+"px"},10)}},{key:"checkWinState",value:function(){var e=this;return this.FIELD.forEach(function(t){t.forEach(function(t){2048===t&&(e.winStatus=!0)})}),this.winStatus}}],n=[{key:"makeMatrix",value:function(e){var t=[],r=0;if(!e)for(var n=0;n<4;n++){t.push([]);for(var o=0;o<4;o++)t[n].push(0)}if(e)for(var a=0;a<e.length/4;a++){t.push([]);for(var i=0;i<e.length/4;i++)t[a].push(e[r]),r++}return t}}],e&&r(o.prototype,e),n&&r(o,n),o}()}.GameClass,o=document.querySelectorAll(".field-cell"),a=new n(o);function i(e){var r=a.FIELD.map(function(e){return t(e)});a.madeMove=!0,a.moveField(a.FIELD,e.key,a.moveList),a.visualize(e.key,r);for(var n=0;n<a.moveList.length;n++)for(var o=0;o<a.moveList.length;o++)a.moveList[n][o]=0;document.querySelector(".game-score").innerText="".concat(a.score),a.canMoveHorizontaly(a.FIELD)||a.canMoveVerticaly(a.FIELD)||a.hasEmptySpace(a.FIELD)?a.winStatus&&(document.querySelector(".game-field__game-win").style.display="flex",document.removeEventListener("keydown",i),setTimeout(function(){document.querySelector(".game-field__game-win").style.opacity="1",document.querySelector(".message-win").classList.remove("hidden")},10)):(document.querySelector(".game-field__game-over").style.display="flex",document.removeEventListener("keydown",i),setTimeout(function(){document.querySelector(".game-field__game-over").style.opacity="1",document.querySelector(".message-lose").classList.remove("hidden")},10))}a.FIELD=n.makeMatrix(),a.moveList=n.makeMatrix(),a.HTML_MATRIX=n.makeMatrix(o),document.body.querySelector(".button").addEventListener("click",function(){document.querySelector(".message-start").classList.add("hidden"),a.isGameStarted&&(a.FIELD.forEach(function(e,t){e.forEach(function(e,r){a.FIELD[t][r]=0})}),o.forEach(function(e){for(e.innerHTML="";e.firstChild;)e.removeChild(e.firstChild)}),document.body.querySelector("button").classList="button start",document.body.querySelector("button").innerHTML="Start",document.body.querySelector(".game-score").innerHTML="0",document.body.querySelector(".game-field__game-over").style.display="none",document.body.querySelector(".game-field__game-win").style.display="none",document.body.querySelector(".message-lose").classList.add("hidden"),document.body.querySelector(".message-win").classList.add("hidden"),a.madeMove=!1,a.score=0),a.madeMove||(setTimeout(function(){a.randomCell(a.FIELD),a.randomCell(a.FIELD),a.visualize(a.FIELD,a.HTML_MATRIX,a.moveList)},50),document.querySelector(".button").classList="button restart",document.querySelector(".button").innerText="Restart",a.isGameStarted=!0),document.addEventListener("keydown",i)})}();
//# sourceMappingURL=index.6da13912.js.map
